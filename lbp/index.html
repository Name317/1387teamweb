<html>
    <head>
        <meta charset = "UTF-8">
        <title>1387网</title>
        <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests;">
        <link href="favicon.ico" rel="icon">
        <style>
            .backgroundiv {
              background-color: #3498db;
              color: white;
              padding: 20px;
              border: 2px solid #2980b9;
              margin: 20px;
              text-align: center;
            }
            a{
              text-decoration: none;
            }
	    	.divdiv{
              background-color: #ffffff;
              color: black;
              padding: 5px;
              border: 2px solid black;
              margin: 5px;
			  text-align: left
            }
	    	.divdiv:hover{
              background-color: #eeeeee;
              color: black;
              padding: 5px;
              border: 2px solid black;
              margin: 5px;
			  text-align: left;
            }
        </style>
    </head>
    <body style="background-image: url('https://cdn.luogu.com.cn/upload/image_hosting/n958y1vp.png'); background-size: cover; background-repeat: no-repeat;">
        <input type = "button" value = "跳转回主页" onclick = "window.location.href='https://name317.github.io'">
        <hr>
        <div class = "backgroundiv">
            <h1>这里是 1387网</h1>
            <strong class = 'dename'>User Name Loading......</strong>&ensp;&ensp;&ensp;<button onclick = 'window.location.href = "https://name317.github.io/1387teamweb/login";'>登录</button>&ensp;&ensp;&ensp;<button onclick = 'window.location.href = "https://name317.github.io/1387teamweb/lange";'>注册</button>&ensp;&ensp;&ensp;<button onclick = 'dete();'>退登</button>&ensp;&ensp;&ensp;&ensp;&ensp;|&ensp;&ensp;&ensp;&ensp;&ensp;<button onclick = 'window.location.href = "https://name317.github.io/1387teamweb";'>团队主页</button>&ensp;&ensp;&ensp;<button onclick = 'window.location.href = "https://name317.github.io/1387teamweb/young";'>young社的事</button>&ensp;&ensp;&ensp;<button onclick = 'window.location.href = "https://name317.github.io/1387teamweb/1387";'>1387的事</button>&ensp;&ensp;&ensp;<button onclick = 'window.location.href = "https://name317.github.io/1387teamweb/cal";'>公告</button>&ensp;&ensp;&ensp;<button onclick = 'window.location.href = "https://name317.github.io/1387teamweb/lbp";'>犇犇</button>&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;相关链接&ensp;|&ensp;<button onclick = 'window.open("https://www.luogu.com.cn/team/74385")'>1387洛谷社（young）</button>&ensp;&ensp;&ensp;<button onclick = 'window.open("https://www.40code.com/#page=studio&id=535")'>1387 40code社</button>&ensp;&ensp;&ensp;<button onclick = 'window.open("https://www.ccw.site/topic/1387%E7%A4%BECCW%E5%88%86%E7%A4%BE")'>1387共创世界社</button>&ensp;
        <script>
            function dete(){
                window.localStorage.setItem('nowname','null');
                location.reload();
            }
            var dy = window.localStorage.getItem('nowname');
            if (dy === 'null' || dy == null || dy == ''){
                document.querySelector('strong.dename').textContent = '未登录';
            }
            else{
                document.querySelector('strong.dename').textContent = dy;
            }
        </script>
	<hr>
        </div>
        <br>
        <div class = "backgroundiv" id = motu>
              <h1>犇犇</h1>
			  <h4>超过50条的消息会被删除！</h4>
        </div>
        <script>
            function apt(tin,wm){
			    return '&' + tin + '=' + wm;
    		}
    		function apd(act){
				var yon = 'https://tinywebdb.appinventor.space/api?user=turbo317&secret=bb6dc299&action=' + act;
				return yon;
    		}
    		function pt(o,...args){
				var xhr = new XMLHttpRequest();
    		    var url = '';
				if (o === 'count'){
					url = apd(o);
				}
				else if (o === 'get'){
					url = apd(o) + apt('tag',args[0]);
				}
				else if (o === 'delete'){
					url = apd(o) + apt('tag',args[0]);
				}
				else if (o === 'update'){
					url = apd(o) + apt('tag',args[0]) + apt('value',args[1]);
				}
				else if (o === 'search'){
					url = apd(o) + apt('no',args[0]) + apt('count',args[1]) + apt('tag',args[2]) + apt('type',args[3]);
				}
				xhr.open("GET", url, false); 
				xhr.send();
				if (xhr.status === 200) {
				    return(xhr.responseText);
				} else {
				    return(xhr.statusText);
				}
   			};
			function app(nero){
				var parentDiv = document.getElementById('motu');
				var newDiv = document.createElement('div');
				newDiv.className = 'divdiv';
				newDiv.innerHTML = nero;
				parentDiv.appendChild(newDiv);
			}
			function dob(){
				var cnd0 = pt('get','speak_counter');
				var cnd = cnd0['speak_counter'];
				if (cnd == 'null'){
					pt('update','speak_counter','0');
					cnd = 0;
				}
				var up0 = pt('get','speak_upel');
				var up = cnd0['speak_upel'];
				console.log(up0);
				console.log(up);
				console.log(cnd0);
				console.log(cnd);
				if (up == 'null'){
					pt('update','speak_upel','0');
					up = 0;
				} 
				for (var i = up;i <= up - cnd + 1;i++){
					var dd0 = pt('get','speak_user_' + String(i));
					var dd = dd0['speak_user_' + String(i)];
					var d0 = pt('get','speak_thing_' + String(i));
					var d = dd0['speak_thing_' + String(i)];
					app(dd + ' : ' + d);
					console.log(dd + ' ' + d);
				}
			}
			app('测试 test');
			dob();
        </script>
    </body>
</html>
